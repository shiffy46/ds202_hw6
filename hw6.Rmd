---
title: "Homework_6"
author: "Sam Shifflett"
date: "4/23/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Retrieve Data
```{r}
library(tidyverse)
Best_in_Show = readxl::read_xlsx('Best_in_Show.xlsx', sheet='Best in show full sheet')
Best_in_Show
#1(breed),3(type),5(possible data score),6/7(two different Popularity),12(intelligence),26(dataScore),32(Size)
Best_in_Show_data = Best_in_Show %>% select(c(1,3,5,6,12,32))
names(Best_in_Show_data) = c("Dog Breed", "Category", "Data Score", "Popularity", "Intelligence", "Size")
Best_in_Show_data = Best_in_Show_data[4:nrow(Best_in_Show_data),]
Best_in_Show_data
```

```{r}
#intelligence will be upright or down triangle "shape=24,25"
#color/fill will be the category
#Size will be the size of the point
# y will be the popularity
# x will be the data score
install.packages("ggrepel")
library(ggrepel)
testingDF
testingDF = Best_in_Show_data
names(testingDF) = make.names(names(testingDF))
testingDF = testingDF[complete.cases(testingDF),]
testingDF = testingDF %>% transform(Intelligence = case_when(
    Intelligence <= 0.5 ~ "Dumb",
    Intelligence > 0.5 ~ "Clever"
))
testingDF$Data.Score = as.numeric(testingDF$Data.Score)
testingDF$Popularity = as.numeric(testingDF$Popularity)
testingDF
annotations <- data.frame(
        xpos = c(-Inf,-Inf,Inf,Inf),
        ypos =  c(-Inf, Inf,-Inf,Inf),
        annotateText = c("The Rightly Ignored","Inexplicably Overrated"
                        ,"Overlooked Treasures","Hot Dogs!"),
        hjustvar = c(0,0,1,1) ,
        vjustvar = c(0,1,0,1))
ggplot(testingDF, aes(Data.Score,Popularity, shape = factor(Intelligence), size = fct_rev(factor(Size)), color = Category, label=Dog.Breed)) + geom_point(alpha = 0.75) + geom_vline(xintercept = 2.45) + geom_hline(yintercept = 87 )+ scale_x_continuous(limits=c(0.95, 3.80))+ylim(175,-5) + geom_text_repel(size = 2, segment.size=0.2)


#Sources
#https://stackoverflow.com/questions/32123288/position-ggplot-text-in-each-corner

```